(window.webpackJsonp=window.webpackJsonp||[]).push([[1,15],{340:function(e,t,r){var content=r(347);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(78).default)("bfcbc5c2",content,!0,{sourceMap:!1})},341:function(e,t,r){"use strict";r.r(t);var n=r(19),o=r(0),d=r(28),f=r(37),l=(r(47),r(86),r(13),r(5),r(4),r(2),r(6),r(3),r(7),r(184)),h=r(33),c=r(43),v=(r(14),r(34),r(21),r(10)),x=window,m=document.body,w=document.documentElement,y=function(e,t,r){var n=e.className.split(/\s+/),o=n.indexOf(r);"add"===t&&-1==o?(n.push(r),e.className=n.join(" ")):"remove"===t&&-1!=o&&(n.splice(o,1),e.className=n.join(" "))},_=function(e){var t=Math.max(0,x.pageXOffset||w.scrollLeft||m.scrollLeft||0)-(w.clientLeft||0),r=Math.max(0,x.pageYOffset||w.scrollTop||m.scrollTop||0)-(w.clientTop||0);return{x:e?Math.max(0,e.pageX||e.clientX||0)-t:0,y:e?Math.max(0,e.pageY||e.clientY||0)-r:0}},O=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{gridSize:null};Object(h.a)(this,e),this.state=new v.default.observable({isOverDropzone:!1,hoverOffset:{x:0,y:0},isDragging:!1,dragUuid:null,stoneIndex:null,clickItem:null,dragItem:null,startClickPosition:{x:0,y:0}}),this.options=r,this.dropzone=t,this.__onPress=this._onPress.bind(this),this.__onRelease=this._onRelease.bind(this),this.__onMove=this._onMove.bind(this),window.addEventListener("mousedown",this.__onPress,!0),window.addEventListener("touchstart",this.__onPress,!0),window.addEventListener("mouseup",this.__onRelease,!0),window.addEventListener("touchend",this.__onRelease,!0),window.addEventListener("mousemove",this.__onMove,!0),window.addEventListener("touchmove",this.__onMove,!0)}return Object(c.a)(e,[{key:"destroy",value:function(){window.removeEventListener("mousedown",this.__onPress,!0),window.removeEventListener("touchstart",this.__onPress,!0),window.removeEventListener("mouseup",this.__onRelease,!0),window.removeEventListener("touchend",this.__onRelease,!0),window.removeEventListener("mousemove",this.__onMove,!0),window.removeEventListener("touchmove",this.__onMove,!0)}},{key:"_onPress",value:function(e){if(e&&e.target){var t=e.target.closest(".stone");if(!t)return;var r=e.target.closest(".draggable");if(!r)return;window.tetra=r,window.stone=t,e.preventDefault(),this.state.isDragging=!0,this.state.dragUuid=r.dataset.id,this.state.stoneIndex=(n=t,Array.prototype.indexOf.call(n.parentNode.childNodes,n)),this.state.startClickPosition=_(e),this._makeDragItem(r),this._onMove(e)}var n}},{key:"_onRelease",value:function(e){this.state.isDragging=!1,this._trashDragItem()}},{key:"_onMove",value:function(e){if(this.state.dragItem&&this.state.isDragging){e.preventDefault();var t=_(e);if(this._refreshItemPosition(this.state.dragItem,t.x-this.state.startClickPosition.x,t.y-this.state.startClickPosition.y),function(e,t,r){var n=e.getBoundingClientRect(),o=t>n.left&&t<n.left+n.width,d=r>n.top&&r<n.top+n.height;return o&&d}(this.dropzone,t.x,t.y)){this.state.isOverDropzone=!0;var r=function(e,t,r){var n=e.getBoundingClientRect();return{x:t-n.left,y:r-n.top}}(this.dropzone,t.x,t.y),n=this.options.gridSize;n&&(r.x=parseInt(r.x/n),r.y=parseInt(r.y/n));var o=this.state.hoverOffset,d=o.x,f=o.y;d==r.x&&f==r.y||(this.state.hoverOffset=r),this.state.dragItem.style.opacity="0.1"}else this.state.isOverDropzone=!1,this.state.dragItem.style.opacity="1"}}},{key:"_refreshItemPosition",value:function(e,t,r){e.style["-webkit-transform"]="translateX( "+t+"px ) translateY( "+r+"px )",e.style["-moz-transform"]="translateX( "+t+"px ) translateY( "+r+"px )",e.style["-ms-transform"]="translateX( "+t+"px ) translateY( "+r+"px )",e.style.transform="translateX( "+t+"px ) translateY( "+r+"px )"}},{key:"_makeDragItem",value:function(e){this._trashDragItem(),this.state.clickItem=e,this._container=e.parentNode,y(this.state.clickItem,"add","active"),this.state.dragItem=document.createElement(e.tagName),this.state.dragItem.className="dragging",this.state.dragItem.innerHTML=e.innerHTML,this.state.dragItem.style.position="absolute",this.state.dragItem.style["z-index"]="999",this.state.dragItem.style.left=(e.offsetLeft||0)+"px",this.state.dragItem.style.top=(e.offsetTop||0)+"px",this.state.dragItem.style.width=(e.offsetWidth||0)+"px",this.state.dragItem.style.height=(e.offsetHeight||0)+"px",this.state.dragItem.style.cursor="default",this._container.appendChild(this.state.dragItem)}},{key:"_trashDragItem",value:function(){this.state.dragItem&&this.state.clickItem&&(y(this.state.clickItem,"remove","active"),this.state.clickItem=null,this._container.removeChild(this.state.dragItem),this.state.dragItem=null)}}]),e}(),D=function(e,t){return new O(e,t)},k=r(52),T=r(25);function S(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}function I(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?S(Object(source),!0).forEach((function(t){Object(o.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):S(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var W={props:["fields","tetrasWithOffset","userUuid","readOnly","showResult"],data:function(){return{fieldSize:40,borderSize:2,dragState:{},hoverTetraUuid:null}},mounted:function(){this.readOnly||(this._dragAndDrop=D(this.$refs.element,{gridSize:this.fieldDistance}),this.dragState=this._dragAndDrop.state)},beforeDestroy:function(){this._dragAndDrop&&this._dragAndDrop.destroy()},watch:{"dragState.isDragging":function(e,t){!e&&t&&this.dropTetra(this.draggingTetra)}},methods:{mouseOver:function(e,t){var r=this;if(t&&e.tetraWithOffset){var n=e.tetraWithOffset.tetraUuid;this._clearHover&&clearTimeout(this._clearHover),this._clearHover=setTimeout((function(){return r.hoverTetraUuid=n}),50)}else this._clearHover=setTimeout((function(){return r.hoverTetraUuid=null}),50)},isMouseOver:function(e){return this.hoverTetraUuid&&e.tetraWithOffset&&this.hoverTetraUuid==e.tetraWithOffset.tetraUuid},fieldStyle:function(e,t,r){return{width:this.fieldSize+"px",height:this.fieldSize+"px","background-color":l.a.COLORS[e],border:"2px solid "+l.a.BORDER_COLORS[e],top:r*this.fieldDistance+"px",left:t*this.fieldDistance+"px",position:"absolute"}},removeTetra:function(e){if(!this.readOnly&&e.tetraWithOffset){var t=this.tetrasWithOffset.indexOf(e.tetraWithOffset);t>=0&&this.tetrasWithOffset.splice(t,1)}},dropTetra:function(e){if(!this.readOnly&&e){var t=e.tetraUuid,r=e.offset,n=e.isValid,o=e.userUuid;n&&this.tetrasWithOffset.push({tetraUuid:t,offset:r,userUuid:o})}}},computed:{fieldAreaBase:function(){return this.fields.length&&this.fields[0].length&&"object"==Object(f.a)(this.fields[0][0])?this.fields:l.a.fieldsTypesToFieldsObjects(this.fields)},fieldAreaWithTetras:function(){return this.tetrasWithOffset&&this.tetrasWithOffset.length?l.a.fieldsWithTetras(this.fieldAreaBase,this.tetrasWithOffset):this.fieldAreaBase},fieldAreaWithDraggingTetra:function(){if(this.dragState.isDragging&&this.draggingTetra&&this.draggingTetra.tetra){var area=this.fieldAreaWithTetras.map((function(e){return Object(d.a)(e)})),e=this.draggingTetra;return l.a.addTetraToArea(area,e,(function(t){return e.isValid?{dragCube:t,dragTetraWithOffset:e}:{invalidDragCube:t,dragTetraWithOffset:e}})),area}return this.fieldAreaWithTetras},fieldArea:function(){return console.log("compute fieldArea",this.fieldAreaWithDraggingTetra),this.fieldAreaWithDraggingTetra},fightResult:function(){return k.a.getResult(this.fieldArea)},dragData:function(){var e=this.dragState,t=e.dragUuid,r=e.stoneIndex;if(!t)return null;var n=T.a.getTetra(t,this.userUuid);return n?{cube:r>=0&&r<n.cubes.length?n.cubes[r]:null,tetraUuid:t,tetra:n}:null},draggingTetra:function(){return this.draggingTetraWithOffset?I(I({},this.draggingTetraWithOffset),{},{isValid:l.a.isValidPositionForTetra(this.fieldAreaWithTetras,this.draggingTetraWithOffset)}):null},draggingTetraWithOffset:function(){if(this.dragState.isOverDropzone&&this.dragState.hoverOffset&&this.dragData&&this.dragData.tetra&&this.dragData.cube){var e=this.dragState.hoverOffset,t=e.x,r=e.y,o=Object(n.a)(this.dragData.cube.position,2);return{offset:{x:t-o[0],y:r-o[1]},tetra:this.dragData.tetra,tetraUuid:this.dragData.tetraUuid,userUuid:this.userUuid}}return null},fieldDistance:function(){return this.fieldSize+this.borderSize},areaWidth:function(){return this.fields.reduce((function(e,t){return Math.max(e,t.length)}),0)},areaHeight:function(){return this.fields.length},containerStyle:function(){return{width:this.areaWidth*this.fieldDistance-this.borderSize+"px",height:this.areaHeight*this.fieldDistance-this.borderSize+"px",position:"relative"}},widthStyle:function(){return{width:this.areaWidth*this.fieldDistance-this.borderSize+"px"}}}},C=(r(354),r(60)),component=Object(C.a)(W,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{style:e.widthStyle},[r("div",{ref:"element",style:e.containerStyle},e._l(e.fieldArea,(function(t,n){return r("div",{key:"row"+n},e._l(t,(function(t,o){return r("div",{key:"field"+n+"_"+o,style:e.fieldStyle(t.type,o,n),on:{mouseover:function(r){return e.mouseOver(t,!0)},mouseleave:function(r){return e.mouseOver(t,!1)},click:function(t){return e.$emit("fieldClick",[o,n])}}},[t.hasCube?r("div",{staticClass:"field-wrapper",class:{hover:e.isMouseOver(t)},staticStyle:{width:"100%",height:"100%"},on:{click:function(r){return e.removeTetra(t)}}},[t.cube?r("SimpleCube",{staticStyle:{opacity:"1"},attrs:{cube:t.cube,hover:e.isMouseOver(t)}}):e._e(),e._v(" "),t.dragCube?r("SimpleCube",{staticStyle:{opacity:"0.8"},attrs:{cube:t.dragCube}}):e._e(),e._v(" "),t.invalidDragCube?r("SimpleCube",{staticStyle:{opacity:"0.3"},attrs:{cube:t.invalidDragCube}}):e._e()],1):e._e()])})),0)})),0),e._v(" "),e.showResult?r("pre",{staticStyle:{overflow:"auto","max-height":"60vh"}},[e._v(e._s(JSON.stringify(e.fightResult,null,2)))]):e._e()])}),[],!1,null,"3d7a2ade",null);t.default=component.exports;installComponents(component,{SimpleCube:r(351).default})},346:function(e,t,r){"use strict";r(340)},347:function(e,t,r){var n=r(77)(!1);n.push([e.i,'.fade-enter-active[data-v-3d683ef0],.fade-leave-active[data-v-3d683ef0]{transition:opacity .5s}.fade-enter[data-v-3d683ef0],.fade-leave-to[data-v-3d683ef0]{opacity:0}.bounce-enter-active[data-v-3d683ef0]{-webkit-animation:bounce-in-data-v-3d683ef0 .5s;animation:bounce-in-data-v-3d683ef0 .5s}.bounce-leave-active[data-v-3d683ef0]{-webkit-animation:bounce-out-data-v-3d683ef0 .5s;animation:bounce-out-data-v-3d683ef0 .5s}@-webkit-keyframes bounce-in-data-v-3d683ef0{0%{transform:scale(0)}50%{transform:scale(1.5)}to{transform:scale(1)}}@keyframes bounce-in-data-v-3d683ef0{0%{transform:scale(0)}50%{transform:scale(1.5)}to{transform:scale(1)}}@-webkit-keyframes bounce-out-data-v-3d683ef0{0%{transform:scale(1)}to{transform:scale(0)}}@keyframes bounce-out-data-v-3d683ef0{0%{transform:scale(1)}to{transform:scale(0)}}.glowing[data-v-3d683ef0]:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;border:0 solid #fff;box-shadow:0 0 10px #0f0,inset 0 0 5px #0f0;background-color:rgba(0,0,0,.7);z-index:-1;transition:all .5s ease}.rare .glowing[data-v-3d683ef0]:before{background-color:hsla(0,0%,75.3%,.7)}.legendary .glowing[data-v-3d683ef0]:before{background-color:rgba(255,215,0,.7)}.red .glowing[data-v-3d683ef0]:before{box-shadow:0 0 10px red,inset 0 0 5px red}.blue .glowing[data-v-3d683ef0]:before{box-shadow:0 0 10px #003cff,inset 0 0 5px #003cff}.green .glowing[data-v-3d683ef0]:before{box-shadow:0 0 10px #0f0,inset 0 0 5px #0f0}.yellow .glowing[data-v-3d683ef0]:before{box-shadow:0 0 10px #e5ff00,inset 0 0 5px #e5ff00}.orange .glowing[data-v-3d683ef0]:before{box-shadow:0 0 10px #f60,inset 0 0 5px #f60}.purple .glowing[data-v-3d683ef0]:before{box-shadow:0 0 10px #90f,inset 0 0 5px #90f}.white .glowing[data-v-3d683ef0]:before{box-shadow:0 0 10px #fff,inset 0 0 5px #fff}.gray .glowing[data-v-3d683ef0]:before{box-shadow:0 0 10px #777,inset 0 0 5px #777}.smallGlow .red .glowing[data-v-3d683ef0]:before{box-shadow:0 0 4px red,inset 0 0 5px red}.smallGlow .blue .glowing[data-v-3d683ef0]:before{box-shadow:0 0 4px #003cff,inset 0 0 5px #003cff}.smallGlow .green .glowing[data-v-3d683ef0]:before{box-shadow:0 0 4px #0f0,inset 0 0 5px #0f0}.smallGlow .yellow .glowing[data-v-3d683ef0]:before{box-shadow:0 0 4px #e5ff00,inset 0 0 5px #e5ff00}.smallGlow .orange .glowing[data-v-3d683ef0]:before{box-shadow:0 0 4px #f60,inset 0 0 5px #f60}.smallGlow .purple .glowing[data-v-3d683ef0]:before{box-shadow:0 0 4px #90f,inset 0 0 5px #90f}.smallGlow .white .glowing[data-v-3d683ef0]:before{box-shadow:0 0 4px #fff,inset 0 0 5px #fff}.smallGlow .gray .glowing[data-v-3d683ef0]:before{box-shadow:0 0 4px #777,inset 0 0 5px #777}@-webkit-keyframes glowAnimation-data-v-3d683ef0{0%{box-shadow:0 0 10px #0f0,inset 0 0 5px #0f0}20%{box-shadow:0 0 15px #0f0,inset 0 0 10px #0f0}40%{box-shadow:0 0 12px #0f0,inset 0 0 8px #0f0}60%{box-shadow:0 0 10px #0f0,inset 0 0 5px #0f0}80%{box-shadow:0 0 8px #0f0,inset 0 0 3px #0f0}to{box-shadow:0 0 10px #0f0,inset 0 0 5px #0f0}}@keyframes glowAnimation-data-v-3d683ef0{0%{box-shadow:0 0 10px #0f0,inset 0 0 5px #0f0}20%{box-shadow:0 0 15px #0f0,inset 0 0 10px #0f0}40%{box-shadow:0 0 12px #0f0,inset 0 0 8px #0f0}60%{box-shadow:0 0 10px #0f0,inset 0 0 5px #0f0}80%{box-shadow:0 0 8px #0f0,inset 0 0 3px #0f0}to{box-shadow:0 0 10px #0f0,inset 0 0 5px #0f0}}.reflection[data-v-3d683ef0]{-webkit-box-reflect:below 0 linear-gradient(transparent,transparent,rgba(0,0,0,.411))}.cube__face[data-v-3d683ef0]{width:100%;height:100%;color:#fff;text-align:center;font-size:20px}.legendary .cube__face[data-v-3d683ef0],.rare .cube__face[data-v-3d683ef0]{color:#000}.draggable .cube__face--front[data-v-3d683ef0]{cursor:move}.cube__face--front[data-v-3d683ef0]{transform:rotateY(0deg) translateZ(21px)}',""]),e.exports=n},348:function(e,t,r){var content=r(355);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(78).default)("1362c267",content,!0,{sourceMap:!1})},351:function(e,t,r){"use strict";r.r(t);var n=r(0),o={props:["cube","hover"],methods:{diceClass:function(e){return e?Object(n.a)({rare:"rare"==e.rarity,legendary:"legendary"==e.rarity},e.color,!0):{white:!0}}},computed:{stone:function(){var text=this.cube.dice?this.cube.dice.level:null;return this.cube.dice&&this.cube.dice.maxLevel&&this.hover&&(text=this.cube.dice.maxLevel),{cube:this.cube,text:text,class:this.diceClass(this.cube.dice)}}}},d=(r(346),r(60)),component=Object(d.a)(o,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{class:e.stone.class,staticStyle:{width:"100%",height:"100%",padding:"3px"}},[r("div",{staticClass:"cube__face glowing cube__face--front"},[r("transition",{attrs:{name:"fade"}},[e.stone.text?r("span",[e._v("\n        "+e._s(e.stone.text)+"\n      ")]):e._e()])],1)])}),[],!1,null,"3d683ef0",null);t.default=component.exports},354:function(e,t,r){"use strict";r(348)},355:function(e,t,r){var n=r(77)(!1);n.push([e.i,".field-wrapper[data-v-3d7a2ade]{transition:transform .4s ease;cursor:pointer;position:relative}.field-wrapper.hover[data-v-3d7a2ade]{transform:scale(1.3)}.field-wrapper>*[data-v-3d7a2ade]{position:absolute;top:0;left:0}",""]),e.exports=n}}]);